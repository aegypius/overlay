box: wercker-labs/docker
build:
  steps:
    - script:
        name: Pull latest overlay-env
        code: |-
          mkdir "$WERCKER_CACHE_DIR/docker-images/"
          if test -f "$WERCKER_CACHE_DIR/docker-images/overlay-env.tgz"; then docker load < "$WERCKER_CACHE_DIR/docker-images/overlay-env.tgz"; fi
          docker pull aegypius/overlay-env:latest
          docker save aegypius/overlay-env:latest > "$WERCKER_CACHE_DIR/docker-images/overlay-env.tgz"

    - script:
        name: List docker images (debug)
        code: |-
          docker images

    - script:
        name: Checking using repoman
        code: |-
          docker run -v $(pwd):/overlay -i -t aegypius/overlay-env:latest repoman full --include-dev --pretend --verbose
